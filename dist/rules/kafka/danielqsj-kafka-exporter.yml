groups:

- name: DanielqsjKafkaExporter

  rules:

    - alert: KafkaTopicsReplicas
      expr: 'sum(kafka_topic_partition_in_sync_replica) by (topic) < 3'
      for: 0m
      labels:
        severity: critical
      annotations:
        summary: "{% if $labels.alias %}{{ $labels.alias }}{% else %}{{ $labels.instance }}: Kafka topics replicas"
        description: "Kafka topic in-sync partition\nVALUE = {{ $value }}\n{{ range $k, $v := $labels }}{{ $k }}=\"{{ $v }}\" {{ end }}"

    - alert: KafkaConsumersGroup
      expr: 'sum(kafka_consumergroup_lag) by (consumergroup) > 50'
      for: 1m
      labels:
        severity: critical
      annotations:
        summary: "{% if $labels.alias %}{{ $labels.alias }}{% else %}{{ $labels.instance }}: Kafka consumers group"
        description: "Kafka consumers group\nVALUE = {{ $value }}\n{{ range $k, $v := $labels }}{{ $k }}=\"{{ $v }}\" {{ end }}"

