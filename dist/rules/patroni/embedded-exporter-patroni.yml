groups:

- name: EmbeddedExporterPatroni

  rules:

    - alert: PatroniHasNoLeader
      expr: '(max by (scope) (patroni_master) < 1) and (max by (scope) (patroni_standby_leader) < 1)'
      for: 0m
      labels:
        severity: critical
      annotations:
        summary: "{% if $labels.alias %}{{ $labels.alias }}{% else %}{{ $labels.instance }}: Patroni has no Leader"
        description: "A leader node (neither primary nor standby) cannot be found inside the cluster {{ $labels.scope }}\nVALUE = {{ $value }}\n{{ range $k, $v := $labels }}{{ $k }}=\"{{ $v }}\" {{ end }}"

